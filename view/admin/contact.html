{extend name="admin/layout" /}

{block name="content"}
<div class="card">
    <div class="card-header">
        <h5 class="mb-0">联系信息管理</h5>
    </div>
    <div class="card-body">
        <form id="contactForm">
            <div class="row">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="contactEmail" class="form-label">邮箱</label>
                        <input type="email" class="form-control" id="contactEmail" required>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="contactWechat" class="form-label">微信</label>
                        <input type="text" class="form-control" id="contactWechat">
                    </div>
                </div>
            </div>
            
            <div class="row">
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="contactQQ" class="form-label">QQ</label>
                        <input type="text" class="form-control" id="contactQQ">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="mb-3">
                        <label for="contactAddress" class="form-label">地址</label>
                        <input type="text" class="form-control" id="contactAddress">
                    </div>
                </div>
            </div>
            
            <div class="mb-3">
                <label for="contactGithub" class="form-label">GitHub</label>
                <input type="url" class="form-control" id="contactGithub">
            </div>
            
            <div class="mb-3">
                <label class="form-label">工作时间</label>
                <div class="row">
                    <div class="col-md-4">
                        <div class="input-group">
                            <span class="input-group-text">工作日</span>
                            <input type="text" class="form-control" id="workdayHours" placeholder="09:00 - 18:00">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="input-group">
                            <span class="input-group-text">周六</span>
                            <input type="text" class="form-control" id="saturdayHours" placeholder="10:00 - 16:00">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="input-group">
                            <span class="input-group-text">周日</span>
                            <input type="text" class="form-control" id="sundayHours" placeholder="休息">
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="text-end">
                <button type="button" class="btn btn-primary" onclick="saveContactInfo()">
                    <i class="bi bi-save"></i> 保存信息
                </button>
            </div>
        </form>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    loadContactInfo();
});

function loadContactInfo() {
    axios.get('/contact/info')
        .then(response => {
            if (response.data.code === 200) {
                const contact = response.data.data;
                document.getElementById('contactEmail').value = contact.email || '';
                document.getElementById('contactWechat').value = contact.wechat || '';
                document.getElementById('contactQQ').value = contact.qq || '';
                document.getElementById('contactAddress').value = contact.address || '';
                document.getElementById('contactGithub').value = contact.github || '';
                
                // 设置工作时间
                if (contact.working_hours) {
                    document.getElementById('workdayHours').value = contact.working_hours.workday || '';
                    document.getElementById('saturdayHours').value = contact.working_hours.saturday || '';
                    document.getElementById('sundayHours').value = contact.working_hours.sunday || '';
                }
            }
        })
        .catch(error => {
            console.error('加载联系信息失败:', error);
            utils.showError('加载联系信息失败');
        });
}

function saveContactInfo() {
    const formData = {
        email: document.getElementById('contactEmail').value,
        wechat: document.getElementById('contactWechat').value,
        qq: document.getElementById('contactQQ').value,
        address: document.getElementById('contactAddress').value,
        github: document.getElementById('contactGithub').value,
        working_hours: {
            workday: document.getElementById('workdayHours').value,
            saturday: document.getElementById('saturdayHours').value,
            sunday: document.getElementById('sundayHours').value
        }
    };
    
    axios.post('/contact/update', formData)
        .then(response => {
            if (response.data.code === 200) {
                utils.showSuccess(response.data.message);
            }
        })
        .catch(error => {
            console.error('保存联系信息失败:', error);
            utils.showError('保存联系信息失败');
        });
}
</script>
{/block} 